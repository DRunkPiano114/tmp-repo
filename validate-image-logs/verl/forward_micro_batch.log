================================================================================
Test time: 2026-02-19 18:24:50
Function name: forward_micro_batch
Test file: test_code/test_forward_micro_batch.py
Test framework: unittest
Return code: 1
================================================================================

【STDOUT】
--------------------------------------------------------------------------------

=============
== PyTorch ==
=============

NVIDIA Release 24.08 (build 107063150)
PyTorch Version 2.5.0a0+872d972
Container image Copyright (c) 2024, NVIDIA CORPORATION & AFFILIATES. All rights reserved.
Copyright (c) 2014-2024 Facebook Inc.
Copyright (c) 2011-2014 Idiap Research Institute (Ronan Collobert)
Copyright (c) 2012-2014 Deepmind Technologies    (Koray Kavukcuoglu)
Copyright (c) 2011-2012 NEC Laboratories America (Koray Kavukcuoglu)
Copyright (c) 2011-2013 NYU                      (Clement Farabet)
Copyright (c) 2006-2010 NEC Laboratories America (Ronan Collobert, Leon Bottou, Iain Melvin, Jason Weston)
Copyright (c) 2006      Idiap Research Institute (Samy Bengio)
Copyright (c) 2001-2004 Idiap Research Institute (Ronan Collobert, Samy Bengio, Johnny Mariethoz)
Copyright (c) 2015      Google Inc.
Copyright (c) 2015      Yangqing Jia
Copyright (c) 2013-2016 The Caffe contributors
All rights reserved.

Various files include modifications (c) NVIDIA CORPORATION & AFFILIATES.  All rights reserved.

This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.nvidia.com/ngc/nvidia-deep-learning-container-license

WARNING: The NVIDIA Driver was not detected.  GPU functionality will not be available.
   Use the NVIDIA Container Toolkit to start this container with GPU support; see
   https://docs.nvidia.com/datacenter/cloud-native/ .

NOTE: The SHMEM allocation limit is set to the default of 64MB.  This may be
   insufficient for PyTorch.  NVIDIA recommends the use of the following flags:
   docker run --gpus all --ipc=host --ulimit memlock=-1 --ulimit stack=67108864 ...

Reward model use_remove_padding=False
Reward model use_fused_kernels=False
Reward model use_remove_padding=False
Reward model use_fused_kernels=False
Reward model use_remove_padding=False
Reward model use_fused_kernels=False
Reward model use_remove_padding=False
Reward model use_fused_kernels=False
Reward model use_remove_padding=False
Reward model use_fused_kernels=False
Reward model use_remove_padding=False
Reward model use_fused_kernels=False

【STDERR】
--------------------------------------------------------------------------------
FFF.FF
======================================================================
FAIL: test_different_prompt_lengths (__main__.TestForwardMicroBatch)
Test handling of different prompt lengths - using ground truth code
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/workspace/project/verl/test_examples/prime/code/test_code/test_forward_micro_batch.py", line 239, in test_different_prompt_lengths
    torch.testing.assert_close(token_level_scores_list[i], expected_token_level_scores_list[i], atol=1e-30, rtol=1e-30)
  File "/usr/local/lib/python3.10/dist-packages/torch/testing/_comparison.py", line 1530, in assert_close
    raise error_metas[0].to_error(msg)
AssertionError: Tensor-likes are not close!

Mismatched elements: 12 / 12 (100.0%)
Greatest absolute difference: 0.0009815692901611328 at index (0, 3) (up to 1e-30 allowed)
Greatest relative difference: 0.08445820957422256 at index (0, 3) (up to 1e-30 allowed)

======================================================================
FAIL: test_forward_micro_batch_basic (__main__.TestForwardMicroBatch)
Test _forward_micro_batch basic functionality - using ground truth code
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/workspace/project/verl/test_examples/prime/code/test_code/test_forward_micro_batch.py", line 136, in test_forward_micro_batch_basic
    torch.testing.assert_close(token_level_scores, expected_token_level_scores, atol=1e-30, rtol=1e-30)
  File "/usr/local/lib/python3.10/dist-packages/torch/testing/_comparison.py", line 1530, in assert_close
    raise error_metas[0].to_error(msg)
AssertionError: Tensor-likes are not close!

Mismatched elements: 12 / 14 (85.7%)
Greatest absolute difference: 0.0010017873719334602 at index (1, 4) (up to 1e-30 allowed)
Greatest relative difference: 0.15667954087257385 at index (1, 4) (up to 1e-30 allowed)

======================================================================
FAIL: test_gae_mode_processing (__main__.TestForwardMicroBatch)
Test GAE mode process reward generation - using ground truth code
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/workspace/project/verl/test_examples/prime/code/test_code/test_forward_micro_batch.py", line 184, in test_gae_mode_processing
    torch.testing.assert_close(token_level_scores, expected_token_level_scores, atol=1e-30, rtol=1e-30)
  File "/usr/local/lib/python3.10/dist-packages/torch/testing/_comparison.py", line 1530, in assert_close
    raise error_metas[0].to_error(msg)
AssertionError: Tensor-likes are not close!

Mismatched elements: 8 / 12 (66.7%)
Greatest absolute difference: 0.0008231848478317261 at index (1, 2) (up to 1e-30 allowed)
Greatest relative difference: 0.04113636910915375 at index (0, 2) (up to 1e-30 allowed)

======================================================================
FAIL: test_padding_handling (__main__.TestForwardMicroBatch)
Test padding handling - using ground truth code
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/workspace/project/verl/test_examples/prime/code/test_code/test_forward_micro_batch.py", line 343, in test_padding_handling
    torch.testing.assert_close(token_level_scores, expected_token_level_scores, atol=1e-30, rtol=1e-30)
  File "/usr/local/lib/python3.10/dist-packages/torch/testing/_comparison.py", line 1530, in assert_close
    raise error_metas[0].to_error(msg)
AssertionError: Tensor-likes are not close!

Mismatched elements: 11 / 16 (68.8%)
Greatest absolute difference: 0.0010017873719334602 at index (1, 5) (up to 1e-30 allowed)
Greatest relative difference: 0.15667954087257385 at index (1, 5) (up to 1e-30 allowed)

======================================================================
FAIL: test_reward_granularity_token (__main__.TestForwardMicroBatch)
Test token-level reward allocation - using ground truth code
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/workspace/project/verl/test_examples/prime/code/test_code/test_forward_micro_batch.py", line 304, in test_reward_granularity_token
    torch.testing.assert_close(token_level_scores, expected_token_level_scores, atol=1e-30, rtol=1e-30)
  File "/usr/local/lib/python3.10/dist-packages/torch/testing/_comparison.py", line 1530, in assert_close
    raise error_metas[0].to_error(msg)
AssertionError: Tensor-likes are not close!

Mismatched elements: 10 / 12 (83.3%)
Greatest absolute difference: 0.0009815692901611328 at index (0, 3) (up to 1e-30 allowed)
Greatest relative difference: 0.08445820957422256 at index (0, 3) (up to 1e-30 allowed)

----------------------------------------------------------------------
Ran 6 tests in 0.120s

FAILED (failures=5)

================================================================================
Log end
